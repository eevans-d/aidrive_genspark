# =============================================================================
# VARIABLES DE ENTORNO PARA TESTS E2E E INTEGRACION
# =============================================================================
# Este archivo es de ejemplo y se versiona para guiar la configuracion local.
# NO contiene secretos reales. Copia a .env.test y reemplaza los valores.

# -----------------------------------------------------------------------------
# SUPABASE LOCAL (obtenido de 'supabase status')
# -----------------------------------------------------------------------------
# URL de Supabase local (por defecto cuando ejecutas 'supabase start')
SUPABASE_URL=http://127.0.0.1:54321

# Publishable key (anon key) - visible en 'supabase status'
# Valor de ejemplo - reemplazar con el real de tu instalacion local
SUPABASE_ANON_KEY=sb_publishable_example

# Secret key (service_role key) - visible en 'supabase status'
# Valor de ejemplo - reemplazar con el real de tu instalacion local
SUPABASE_SERVICE_ROLE_KEY=sb_secret_example

# -----------------------------------------------------------------------------
# API PROVEEDOR (autenticacion interna para tests)
# -----------------------------------------------------------------------------
# Shared secret para tests de endpoints protegidos (/sincronizar, /configuracion)
# En tests locales puede ser cualquier string de 32+ chars
# En CI/CD debe coincidir con el configurado en el entorno de staging
API_PROVEEDOR_SECRET=test-secret-for-local-development-minimum-32-characters
# Modo de lectura para api-proveedor: anon (default) o service
API_PROVEEDOR_READ_MODE=anon

# -----------------------------------------------------------------------------
# SCRAPER MAXICONSUMO
# -----------------------------------------------------------------------------
# Modo de lectura para scraper-maxiconsumo: anon (default) o service
# - anon: usa SUPABASE_ANON_KEY para lecturas (fetch, health)
# - service: usa service role para todo (legacy)
# Escrituras siempre usan SUPABASE_SERVICE_ROLE_KEY
SCRAPER_READ_MODE=anon

# CORS: orÃ­genes permitidos (requerido, las peticiones sin Origin ahora se bloquean)
ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# -----------------------------------------------------------------------------
# OPCIONAL: PROXY/CAPTCHA PARA SCRAPER (FASE 9)
# -----------------------------------------------------------------------------
# Si se usa un proxy HTTP para scraping, declarar la URL (sin credenciales reales)
# PROXY_URL=http://user:pass@proxy.example.com:8080
#
# Si se usa un servicio de CAPTCHA, declara el proveedor y la API key (placeholder)
# CAPTCHA_PROVIDER=2captcha
# CAPTCHA_API_KEY=your-captcha-api-key

# -----------------------------------------------------------------------------
# INSTRUCCIONES
# -----------------------------------------------------------------------------
# 1. Copia este archivo a .env.test en la raiz del proyecto.
# 2. Ejecuta 'supabase start' para iniciar Supabase local.
# 3. Ejecuta 'supabase status' y copia los valores reales de:
#    - API URL -> SUPABASE_URL
#    - Publishable key -> SUPABASE_ANON_KEY
#    - Secret key -> SUPABASE_SERVICE_ROLE_KEY
# 4. Configura API_PROVEEDOR_SECRET (puede dejarse el valor por defecto para tests).
# 5. (Opcional) Configura PROXY_URL y CAPTCHA_* si dispones de estos servicios.
# 6. Carga variables antes de tests: source .env.test
# 7. Ejecuta tests:
#    - E2E: bash scripts/run-e2e-tests.sh
#    - Integration: bash scripts/run-integration-tests.sh
#    - Manual: npx vitest run tests/e2e/api-proveedor.smoke.test.ts --config vitest.e2e.config.ts
